# -*- coding: utf-8 -*-
"""pixel ë³„ í¼ìŠ¤ë„ì»¬ëŸ¬ ë¶„ë¥˜ í™•ì¸

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CHoe5WjvWdJeMKpY6Vl-gGzRqLvmRhXr

# ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
"""

import cv2
from matplotlib import pyplot as plt
import numpy as np
from PIL import Image
import requests

"""# RGB ê°’ì„ ì´ìš©í•œ í”½ì…€ ë³„ í´ëž˜ìŠ¤ ë¶„ë¥˜ í™•ì¸"""

# íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
file_path = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/á„‹á…¯á†·á„á…©á†«_jpg/á„€á…©á†¼á„’á…­á„Œá…µá†«.jpg'

image = Image.open(file_path)
image_np = np.array(image)

image_np.shape

height, width, _ = image_np.shape

# RGB ê°’

spring_tone = [253.75, 153.55, 152]
summer_tone = [254, 291.25, 164.5]
fall_tone = [240.75, 199.25, 132.75]
winter_tone = [240, 201.5, 129.5]

# return: 'spring', 'summer', 'fall', 'winter', 'undefined'
def compute_cosine_sim(v1, v2):
    return np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))

# vectorization
def classify_skin_type(pixel): # [216, 233, 243]
    v1 = compute_cosine_sim(pixel, spring_tone)
    v2 = compute_cosine_sim(pixel, summer_tone)
    v3 = compute_cosine_sim(pixel, fall_tone)
    v4 = compute_cosine_sim(pixel, winter_tone)

    _class = ['spring', 'summer', 'fall', 'winter'][np.argmax([v1, v2, v3, v4])]
    _distance = np.max([v1, v2, v3, v4])
    return _class,_distance

# ë‘˜ì˜ ìœ ì‚¬ë„ í™•ì¸
# v1 = [216, 233, 243]
# v2 = [253.75, 153.55, 152]

# print(compute_cosine_sim(spring_tone, fall_tone))
# print(compute_cosine_sim(spring_tone, winter_tone))

from tqdm import tqdm

results = np.zeros_like(image_np, dtype='uint8') # 0-255
results_distance = np.zeros_like(image_np, dtype='float') # 0-255

color_map = {
    "spring": [255, 0, 0],
    "summer": [0, 255, 0],
    "fall": [0, 0, 255],
    "winter": [255, 255, 0],
    # "warm": [255, 0, 0],
    # "cool": [0, 0, 255],
    "undefined": [0, 0, 0],
}

for j in tqdm(range(height)):
    for i in range(width):
        current_pixel = image_np[j, i]
        cls, dist = classify_skin_type(current_pixel)
        results[j, i] = color_map[cls]
        results_distance[j, i] = dist

# ì •ëŸ‰/ì •ì„±
plt.imshow(results)

plt.imshow(image_np)

"""- ì˜¤ìž‰, ê³µíš¨ì§„ì€ ì—¬ë¦„ ì¿¨, ë´„ ì›œì˜ ë¹„ìœ¨ì´ ë†’ê²Œ ë‚˜ì™”ëŠ”ë°, í”½ì…€ë¡œ ë³´ë‹ˆ ë´„, ê°€ì„, ê²¨ìš¸ì´ ë§Žì´ ë‚˜ì˜´"""

# Create a new figure
plt.figure()

# Add the first image to the left subplot
plt.subplot(1, 2, 1)  # Arguments are: nrows, ncols, index
plt.imshow(image_np)
plt.title('Original')

# Add the second image to the right subplot
plt.subplot(1, 2, 2)
plt.imshow(results)
plt.title('Pixel value')

# Display the plot
plt.show()

"""- í•œ ë²ˆ ë” ëŒë¦¬ë‹ˆê¹Œ ë‹¤ë¥´ê²Œ ë‚˜ì˜´. ì‹œë„í•  ë•Œë§ˆë‹¤ ì¡°ê¸ˆì”© ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ëŠ” ê²ƒ ê°™ë‹¤.

## ì›œí†¤ ì „ì²´ ë½‘ê¸°
"""

import os

# íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/á„‹á…¯á†·á„á…©á†«_jpg/'

# ì§€ì •ëœ ë””ë ‰í† ë¦¬ ë‚´ì˜ ëª¨ë“  jpg íŒŒì¼
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

for file in files:
    file_path = os.path.join(directory, file)

    image = Image.open(file_path).resize((224,224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')
    results_distance = np.zeros_like(image_np, dtype='float')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]
            results_distance[j, i] = dist

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the first image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the second image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel value')

    # Display the plot
    plt.show()



"""## ì¿¨í†¤ ì „ì²´ ë½‘ê¸°"""

import os

# íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì¿¨á„á…©á†«_jpg/'

# ì§€ì •ëœ ë””ë ‰í† ë¦¬ ë‚´ì˜ ëª¨ë“  jpg íŒŒì¼
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

for file in files:
    file_path = os.path.join(directory, file)

    image = Image.open(file_path).resize((224,224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')
    results_distance = np.zeros_like(image_np, dtype='float')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]
            results_distance[j, i] = dist

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the first image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the second image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel value')

    # Display the plot
    plt.show()



"""## ì¼ë°˜ì¸ ë°ì´í„° í™•ì¸"""

import os

# íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/train data/'

# ì§€ì •ëœ ë””ë ‰í† ë¦¬ ë‚´ì˜ ëª¨ë“  jpg íŒŒì¼
files = [f for f in os.listdir(directory) if f.endswith('.JPG')]
files = files[:50] # 50ê°œë§Œ ë¨¼ì € í™•ì¸..í•˜ë ¤í–ˆëŠ”ë°

for file in files:
    file_path = os.path.join(directory, file)

    image = Image.open(file_path).resize((224,224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')
    results_distance = np.zeros_like(image_np, dtype='float')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]
            results_distance[j, i] = dist

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the first image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the second image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel value')

    # Display the plot
    plt.show()

"""- ì¼ë°˜ì¸ ë°ì´í„°ëŠ” ì½”ë“œê°€ ì•ˆ ëŒì•„ê°€ì„œ ë­ê°€ ìž˜ëª»ëëŠ”ì§€ ê³„ì† í™•ì¸í–ˆëŠ”ë° í™•ìž¥ìžê°€ ë‹¬ëžë‹¤. ì „ì— ë¼ë²¨ë§ ë¶„ë¥˜ì½”ë“œì—ì„œë„ ì•ˆ ëë˜ ì´ìœ ê°€ í™•ìž¥ìž ë•Œë¬¸ì´ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìžˆì—ˆë‹¤.

# HSV ê°’ì„ ì´ìš©í•œ í”½ì…€ ë³„ í´ëž˜ìŠ¤ ë¶„ë¥˜ í™•ì¸

## ì¿¨í†¤ í™•ì¸
"""

import os
import cv2

# Define the classification ranges
ranges = {
    'spring': {'H': range(20, 211), 'VS': 68.25, 'direction': 'above'},
    'summer': {'H': list(range(0, 21)) + list(range(210, 361)), 'VS': 68.75, 'direction': 'above'},
    'fall': {'H': range(20, 211), 'VS': 68.25, 'direction': 'below'},
    'winter': {'H': list(range(0, 21)) + list(range(210, 361)), 'VS': 68.75, 'direction': 'below'}
}

# Define a function for classification
def classify_hsv(pixel, ranges):
    h, s, v = pixel
    vs = v - s
    for cls, r in ranges.items():
        if h in r['H']:
            if (r['direction'] == 'above' and vs >= r['VS']) or (r['direction'] == 'below' and vs < r['VS']):
                return cls
    return 'undefined'

# Specify the file path
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/á„á…®á†¯á„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = cv2.cvtColor(np.array(image), cv2.COLOR_RGB2HSV)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls = classify_hsv(current_pixel, ranges)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(cv2.cvtColor(image_np, cv2.COLOR_HSV2RGB))
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""- RGBë³´ë‹¤ HSVê°€ ë³€í™˜ ë’¤ì— í™•ì¸í•˜ëŠ” ê²ƒì´ë¼ ê·¸ëŸ° ì§€ ì¢€ ë” ì˜¤ëž˜ ê±¸ë¦°ë‹¤.
- ì—¬ë¦„ì´ ë¶„ë¥˜ë˜ëŠ” ê±´ ë„ˆë¬´ ì¢‹ì€ë°... ê²¨ìš¸ì´ ì•ˆ ë‚˜ì˜¨ë‹¤.ðŸ˜¥

## ì›œí†¤
"""

# Specify the file path
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì›œá„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = cv2.cvtColor(np.array(image), cv2.COLOR_RGB2HSV)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls = classify_hsv(current_pixel, ranges)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(cv2.cvtColor(image_np, cv2.COLOR_HSV2RGB))
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""- ì•„ì•….. ì›œí†¤ë„ í”¼ë¶€ê°€ ì—¬ë¦„ìœ¼ë¡œ ë„ì¶œëœë‹¤.
- RGBì™€ HSVë¥¼ ëª¨ë‘ ì´ìš©í•´ë³´ìž

# LAB ê°’ìœ¼ë¡œ í™•ì¸
"""

import os
import cv2
import numpy as np

# Define the classification criteria
criteria = {
    'warm': np.array([63.45, 11.80, 17.11]),
    'cool': np.array([64.80, 10.87, 15.04])
}

# Define a function for classification
def classify_lab(pixel, criteria):
    distances = {k: np.linalg.norm(pixel - v) for k, v in criteria.items()}
    return min(distances, key=distances.get)

# Specify the file path
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì›œá„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

# Define the color map
color_map = {
    "warm": [0, 0, 0],
    "cool": [255, 255, 255]
}

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = cv2.cvtColor(np.array(image), cv2.COLOR_RGB2Lab)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls = classify_lab(current_pixel, criteria)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(cv2.cvtColor(image_np, cv2.COLOR_Lab2RGB))
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

# Specify the file path
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì¿¨á„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

# Define the color map
color_map = {
    "warm": [0, 0, 0],
    "cool": [255, 255, 255]
}

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = cv2.cvtColor(np.array(image), cv2.COLOR_RGB2Lab)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls = classify_lab(current_pixel, criteria)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(cv2.cvtColor(image_np, cv2.COLOR_Lab2RGB))
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""- LAB ê°’ìœ¼ë¡œ ì‹œë„í•˜ê¸´ í–ˆìœ¼ë‚˜, OpenCVì˜ LABê°’ê³¼ ì¼ë°˜ì ì¸ LABê°’ì€ ë‹¤ë¥´ë‹¤ê³  í•œë‹¤.
- ê·¸ëŸ¼ RGBê°’ì„ ë³€í™˜í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ LABê°’ì„ í•œ ë²ˆ ë” í™•ì¸í•´ë³´ìž.
"""

from skimage import color

warm_tone = [63.45, 11.80, 17.11]
cool_tone = [64.80, 10.87, 15.04]

tones = np.array([warm_tone, cool_tone])

# return: 'warm', 'cool'
def compute_cosine_sim(v1, v2):
    return np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))


# vectorization
def classify_skin_type(pixel): # [216, 233, 243]
    pixel = color.rgb2lab(np.array([pixel])/255.0)  # Convert to LAB space
    similarities = np.array([compute_cosine_sim(pixel, tone) for tone in tones])

    _class = ['warm', 'cool'][np.argmax(similarities)]
    _distance = np.max(similarities)
    return _class,_distance

from tqdm import tqdm

results = np.zeros_like(image_np, dtype='uint8') # 0-255
results_distance = np.zeros_like(image_np, dtype='float') # 0-255

color_map = {
    "warm": [0, 0, 0],
    "cool": [255, 255, 255],
    "undefined": [0, 255, 255]
            }

for j in tqdm(range(height)):
    for i in range(width):
        current_pixel = image_np[j, i]
        cls, dist = classify_skin_type(current_pixel)
        results[j, i] = color_map[cls]
        results_distance[j, i] = dist

plt.imshow(results)

"""## ì¿¨í†¤"""

import os
from skimage import color

# Define the classification criteria
criteria = {
    'warm': np.array([63.45, 11.80, 17.11]),
    'cool': np.array([64.80, 10.87, 15.04])
}

# Function to compute cosine similarity
def compute_cosine_sim(v1, v2):
    return np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))

# Function to classify skin type
def classify_skin_type(pixel):
    pixel = color.rgb2lab(np.array([pixel])/255.0) # Convert to LAB space
    similarities = np.array([compute_cosine_sim(pixel[0], tone) for tone in criteria.values()])

    _class = ['warm', 'cool'][np.argmax(similarities)]
    _distance = np.max(similarities)
    return _class, _distance

# Specify the file path
directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì¿¨á„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

# Define the color map
color_map = {
    "warm": [255, 0, 0],
    "cool": [0, 0, 255]
}

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""## ì›œí†¤"""

directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/prototype/ì›œá„á…©á†«_jpg/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.jpg')]

# Define the color map
color_map = {
    "warm": [255, 0, 0],
    "cool": [0, 0, 255]
}

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""- LABìœ¼ë¡œ í•˜ë‹ˆ ì–´ëŠ ì •ë„ ì›œ, ì¿¨ ë¶„ë¥˜ê°€ ìž˜ ë˜ëŠ” ê²ƒ ê°™ë‹¤.
- ì›œì¸ë° ì¿¨ë¡œ ë‚˜ì˜¤ëŠ” ê²½ìš°ê°€ ìžˆì§€ë§Œ ì—°ì˜ˆì¸ ì‚¬ì§„ì´ë‹¤ ë³´ë‹ˆ ì¡°ëª…ê³¼ í™”ìž¥ìœ¼ë¡œ ì¸í•œ ì˜í–¥ì´ë¼ ìƒê°ëœë‹¤.
- í”„ë¡œì íŠ¸ ì´ˆë°˜ì— LABì„ ì´ìš©í•œ skin detectionì´ ë˜ì§€ ì•Šì•˜ë˜ ì´ìœ ëŠ” openCVë¥¼ ì´ìš©í•´ì„œ ê·¸ëŸ° ê²ƒ ê°™ë‹¤.

## ì¼ë°˜ì¸ ë°ì´í„°
"""

directory = '/content/drive/MyDrive/Colab Notebooks/AIFFEL/Four_seasons/á„‰á…¡á„€á…¨á„Œá…¥á†¯_á„‹á…§á†«á„‹á…¨á„‹á…µá†« á„‹á…µá„†á…µá„Œá…µ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†º/train data/'

# Get all jpg files in the specified directory
files = [f for f in os.listdir(directory) if f.endswith('.JPG')]

# Select only the first 50 files
files = files[:50]

# Define the color map
color_map = {
    "warm": [255, 0, 0],
    "cool": [0, 0, 255]
}

for file in files:
    file_path = os.path.join(directory, file)

    # Load and resize the image
    image = Image.open(file_path).resize((224, 224))
    image_np = np.array(image)

    height, width, _ = image_np.shape
    results = np.zeros_like(image_np, dtype='uint8')

    for j in tqdm(range(height)):
        for i in range(width):
            current_pixel = image_np[j, i]
            cls, dist = classify_skin_type(current_pixel)
            results[j, i] = color_map[cls]

    # Create a new figure
    fig, ax = plt.subplots(1, 2)

    # Add the original image to the left subplot
    ax[0].imshow(image_np)
    ax[0].set_title('Original')

    # Add the classified image to the right subplot
    ax[1].imshow(results)
    ax[1].set_title('Pixel Classification')

    # Display the plot
    plt.show()

"""# LAB + RGB"""



